<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if is_new %}Novo Paciente{% else %}{{ patient.name }}{% endif %} - NutriPlan</title>
    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .measurement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .avatar-placeholder {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: var(--primary-color);
        }
        .avatar-placeholder i {
            font-size: 36px;
        }
        .measurement-card {
            border: 1px solid var(--divider-color);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            background-color: var(--white);
        }
        .measurement-card h4 {
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        .main-measurement {
            border-left: 4px solid var(--primary-color);
        }
        .tab-header {
            display: flex;
            border-bottom: 1px solid var(--divider-color);
            margin-bottom: 20px;
            overflow-x: auto;
            white-space: nowrap;
        }
        .tab-btn {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
        }
        .tab-btn.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .meal-plan-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .meal-plan-card {
            border: 1px solid var(--divider-color);
            border-radius: 8px;
            padding: 15px;
            background-color: var(--white);
        }
        .meal-plan-card.active {
            border-left: 4px solid var(--success);
        }
        .meal-plan-card.expired {
            border-left: 4px solid var(--danger);
        }
        .meal-plan-card.future {
            border-left: 4px solid var(--info);
        }
        .meal-plan-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .meal-plan-title {
            font-weight: 500;
            font-size: 16px;
            color: var(--primary-color);
        }
        .meal-plan-dates {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        .meal-plan-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        .form-row .form-group {
            flex: 1;
        }
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            .patient-header {
                flex-direction: column;
                align-items: flex-start;
            }
            .patient-avatar {
                margin-bottom: 15px;
            }
            .tab-header {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Cabeçalho -->
    <header class="header">
        <a href="{{ url_for('main.index') }}" class="logo">Nutri<span>Plan</span></a>
        <nav>
            <button class="menu-toggle" aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="{{ url_for('main.index') }}" class="nav-link">Início</a>
                </li>
                <li class="nav-item">
                    <a href="{{ url_for('main.dashboard') }}" class="nav-link">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a href="{{ url_for('patient.patients_list') }}" class="nav-link">Pacientes</a>
                </li>
                <li class="nav-item">
                    <a href="{{ url_for('auth.logout') }}" class="nav-link">Sair</a>
                </li>
            </ul>
        </nav>
    </header>

    <!-- Mensagens Flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div class="container">
        <div class="alert alert-{{ category }}">
            {{ message }}
        </div>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}

    <!-- Conteúdo Principal -->
    <div class="container">
        <div class="card">
            {% if is_new %}
            <!-- Formulário de novo paciente -->
            <div class="card-header">
                <h2 class="card-title">Novo Paciente</h2>
                <a href="{{ url_for('patient.patients_list') }}" class="btn btn-info">
                    <i class="fas fa-arrow-left"></i> Voltar
                </a>
            </div>
            <div class="card-content">
                <form method="POST" action="{{ url_for('patient.add_patient') }}" class="needs-validation" id="patientForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name" class="form-label">Nome Completo*</label>
                            <input type="text" id="name" name="name" class="form-control" required>
                            <div class="invalid-feedback">Nome é obrigatório</div>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">E-mail</label>
                            <input type="email" id="email" name="email" class="form-control">
                            <div class="invalid-feedback">Formato de e-mail inválido</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone" class="form-label">Telefone</label>
                            <input type="tel" id="phone" name="phone" class="form-control" placeholder="(00) 00000-0000">
                        </div>
                        <div class="form-group">
                            <label for="birthday" class="form-label">Data de Nascimento</label>
                            <input type="date" id="birthday" name="birthday" class="form-control">
                            <div class="invalid-feedback">Data inválida</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="gender" class="form-label">Gênero</label>
                        <select id="gender" name="gender" class="form-control">
                            <option value="">Selecione...</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Outro">Outro</option>
                            <option value="Prefiro não informar">Prefiro não informar</option>
                        </select>
                    </div>
                    
                    <div class="form-group mt-4">
                        <button type="submit" class="btn">
                            <i class="fas fa-save"></i> Salvar Paciente
                        </button>
                        <a href="{{ url_for('patient.patients_list') }}" class="btn btn-danger">
                            <i class="fas fa-times"></i> Cancelar
                        </a>
                    </div>
                </form>
            </div>
            {% elif is_edit is defined and is_edit %}
            <!-- Formulário de edição de paciente -->
            <div class="card-header">
                <h2 class="card-title">Editar Paciente</h2>
                <a href="{{ url_for('patient.patient_detail', patient_id=patient.id) }}" class="btn btn-info">
                    <i class="fas fa-arrow-left"></i> Voltar
                </a>
            </div>
            <div class="card-content">
                <form method="POST" action="{{ url_for('patient.edit_patient', patient_id=patient.id) }}" class="needs-validation" id="patientForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name" class="form-label">Nome Completo*</label>
                            <input type="text" id="name" name="name" class="form-control" value="{{ patient.name }}" required>
                            <div class="invalid-feedback">Nome é obrigatório</div>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">E-mail</label>
                            <input type="email" id="email" name="email" class="form-control" value="{{ patient.email or '' }}">
                            <div class="invalid-feedback">Formato de e-mail inválido</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="phone" class="form-label">Telefone</label>
                            <input type="tel" id="phone" name="phone" class="form-control" value="{{ patient.phone or '' }}" placeholder="(00) 00000-0000">
                        </div>
                        <div class="form-group">
                            <label for="birthday" class="form-label">Data de Nascimento</label>
                            <input type="date" id="birthday" name="birthday" class="form-control" value="{{ patient.birthday.strftime('%Y-%m-%d') if patient.birthday else '' }}">
                            <div class="invalid-feedback">Data inválida</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="gender" class="form-label">Gênero</label>
                        <select id="gender" name="gender" class="form-control">
                            <option value="">Selecione...</option>
                            <option value="Masculino" {{ 'selected' if patient.gender == 'Masculino' else '' }}>Masculino</option>
                            <option value="Feminino" {{ 'selected' if patient.gender == 'Feminino' else '' }}>Feminino</option>
                            <option value="Outro" {{ 'selected' if patient.gender == 'Outro' else '' }}>Outro</option>
                            <option value="Prefiro não informar" {{ 'selected' if patient.gender == 'Prefiro não informar' else '' }}>Prefiro não informar</option>
                        </select>
                    </div>
                    
                    <div class="form-group mt-4">
                        <button type="submit" class="btn">
                            <i class="fas fa-save"></i> Salvar Alterações
                        </button>
                        <a href="{{ url_for('patient.patient_detail', patient_id=patient.id) }}" class="btn btn-danger">
                            <i class="fas fa-times"></i> Cancelar
                        </a>
                    </div>
                </form>
            </div>
            {% else %}
            <!-- Detalhes do paciente -->
            <div class="card-header">
                <div class="patient-header">
                    <div class="avatar-placeholder">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="patient-info">
                        <h2>{{ patient.name }}</h2>
                        <p>
                            {% if patient.age %}{{ patient.age }} anos • {% endif %}
                            {% if patient.gender %}{{ patient.gender }}{% endif %}
                        </p>
                        {% if patient.email or patient.phone %}
                        <p>
                            {% if patient.email %}<i class="fas fa-envelope"></i> {{ patient.email }}{% endif %}
                            {% if patient.phone %}<i class="fas fa-phone ml-2"></i> {{ patient.phone }}{% endif %}
                        </p>
                        {% endif %}
                    </div>
                </div>
                <div>
                    <a href="{{ url_for('patient.edit_patient', patient_id=patient.id) }}" class="btn btn-warning">
                        <i class="fas fa-edit"></i> Editar
                    </a>
                    <button class="btn btn-danger" onclick="confirmDelete('{{ patient.name }}')">
                        <i class="fas fa-trash"></i> Excluir
                    </button>
                </div>
            </div>
            
            <div class="card-content">
                <!-- Abas -->
                <div class="tab-header">
                    <div class="tab-btn active" data-tab="overview">Visão Geral</div>
                    <div class="tab-btn" data-tab="measurements">Medidas Antropométricas</div>
                    <div class="tab-btn" data-tab="meal-plans">Planos Alimentares</div>
                </div>
                
                <!-- Conteúdo das abas -->
                <div class="tab-content active" id="overview">
                    <!-- Última medição -->
                    {% if last_measurement %}
                    <h3>Última Medição ({{ last_measurement.date.strftime('%d/%m/%Y') }})</h3>
                    <div class="measurement-grid">
                        <div class="measurement-card main-measurement">
                            <h4>IMC</h4>
                            <div class="measurement-value">{{ last_measurement.imc|round(1) }}</div>
                            <div class="measurement-label">{{ last_measurement.imc_classification }}</div>
                        </div>
                        <div class="measurement-card">
                            <h4>Peso</h4>
                            <div class="measurement-value">{{ last_measurement.weight }} kg</div>
                        </div>
                        <div class="measurement-card">
                            <h4>Altura</h4>
                            <div class="measurement-value">{{ last_measurement.height }} cm</div>
                        </div>
                        {% if last_measurement.tmb %}
                        <div class="measurement-card">
                            <h4>TMB</h4>
                            <div class="measurement-value">{{ last_measurement.tmb|round|int }} kcal</div>
                            <div class="measurement-label">Taxa Metabólica Basal</div>
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Gráficos de Evolução -->
                    <h3>Evolução</h3>
                    <div class="row">
                        <div class="col-6">
                            <div class="chart-container">
                                <canvas id="weightChart" data-values="{{ weight_data }}"></canvas>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="chart-container">
                                <canvas id="imcChart" data-values="{{ imc_data }}"></canvas>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Nenhuma medição registrada para este paciente.
                    </div>
                    {% endif %}
                    
                    <!-- Plano Alimentar Atual -->
                    {% if current_meal_plan %}
                    <h3>Plano Alimentar Atual</h3>
                    <div class="card meal-plan-card active">
                        <div class="meal-plan-header">
                            <div class="meal-plan-title">{{ current_meal_plan.title }}</div>
                            <div>{{ current_meal_plan.total_calories }} kcal/dia</div>
                        </div>
                        <div class="meal-plan-dates">
                            <i class="far fa-calendar-alt"></i> 
                            {{ current_meal_plan.start_date.strftime('%d/%m/%Y') }} 
                            {% if current_meal_plan.end_date %}
                                até {{ current_meal_plan.end_date.strftime('%d/%m/%Y') }}
                            {% else %}
                                (sem data final)
                            {% endif %}
                        </div>
                        <div class="meal-plan-actions">
                            <a href="{{ url_for('meal.meal_plan_detail', plan_id=current_meal_plan.id) }}" class="btn btn-sm">
                                <i class="fas fa-eye"></i> Ver Detalhes
                            </a>
                        </div>
                    </div>
                    {% else %}
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Nenhum plano alimentar ativo.
                        <a href="{{ url_for('meal.add_meal_plan', patient_id=patient.id) }}" class="btn btn-sm" style="margin-left: 10px;">
                            <i class="fas fa-plus"></i> Criar Plano
                        </a>
                    </div>
                    {% endif %}
                </div>
                
                <div class="tab-content" id="measurements">
                    <div class="card-header">
                        <h3>Medidas Antropométricas</h3>
                        <button class="btn" onclick="showMeasurementForm()">
                            <i class="fas fa-plus"></i> Nova Medição
                        </button>
                    </div>
                    
                    <!-- Formulário de Nova Medição (inicialmente oculto) -->
                    <div id="measurementForm" style="display: none;" class="card mb-4">
                        <form method="POST" action="{{ url_for('patient.add_measurement', patient_id=patient.id) }}" class="needs-validation" id="measurementFormData">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="date" class="form-label">Data da Medição*</label>
                                    <input type="date" id="date" name="date" class="form-control" value="{{ now_date }}" required>
                                    <div class="invalid-feedback">Data é obrigatória</div>
                                </div>
                                <div class="form-group">
                                    <label for="weight" class="form-label">Peso (kg)*</label>
                                    <input type="number" id="weight" name="weight" class="form-control" step="0.1" min="0" required>
                                    <div class="invalid-feedback">Peso é obrigatório</div>
                                </div>
                                <div class="form-group">
                                    <label for="height" class="form-label">Altura (cm)*</label>
                                    <input type="number" id="height" name="height" class="form-control" step="0.1" min="0" required>
                                    <div class="invalid-feedback">Altura é obrigatória</div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="waist" class="form-label">Cintura (cm)</label>
                                    <input type="number" id="waist" name="waist" class="form-control" step="0.1" min="0">
                                </div>
                                <div class="form-group">
                                    <label for="hip" class="form-label">Quadril (cm)</label>
                                    <input type="number" id="hip" name="hip" class="form-control" step="0.1" min="0">
                                </div>
                                <div class="form-group">
                                    <label for="body_fat" class="form-label">Gordura Corporal (%)</label>
                                    <input type="number" id="body_fat" name="body_fat" class="form-control" step="0.1" min="0" max="100">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn">
                                    <i class="fas fa-save"></i> Salvar Medição
                                </button>
                                <button type="button" class="btn btn-danger" onclick="hideMeasurementForm()">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                            </div>
                        </form>
                    </div>
                    
                    <!-- Histórico de Medições -->
                    {% if patient.measurements %}
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Peso (kg)</th>
                                    <th>Altura (cm)</th>
                                    <th>IMC</th>
                                    <th>Classificação</th>
                                    <th>Cintura (cm)</th>
                                    <th>Quadril (cm)</th>
                                    <th>% Gordura</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for measurement in patient.measurements|sort(attribute='date', reverse=True) %}
                                <tr>
                                    <td>{{ measurement.date.strftime('%d/%m/%Y') }}</td>
                                    <td>{{ measurement.weight }}</td>
                                    <td>{{ measurement.height }}</td>
                                    <td>{{ measurement.imc|round(1) }}</td>
                                    <td>{{ measurement.imc_classification }}</td>
                                    <td>{{ measurement.waist or '-' }}</td>
                                    <td>{{ measurement.hip or '-' }}</td>
                                    <td>{{ measurement.body_fat or '-' }}</td>
                                    <td>
                                        <button class="btn btn-sm btn-danger" onclick="confirmMeasurementDelete({{ measurement.id }})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Formulário para exclusão de medição -->
                    <form id="deleteMeasurementForm" method="POST" style="display: none;">
                        <input type="hidden" name="measurement_id" id="measurementIdToDelete">
                    </form>
                    {% else %}
                    <div class="alert alert-info text-center">
                        Nenhuma medição registrada para este paciente.
                    </div>
                    {% endif %}
                </div>
                
                <div class="tab-content" id="meal-plans">
                    <div class="card-header">
                        <h3>Planos Alimentares</h3>
                        <a href="{{ url_for('meal.add_meal_plan', patient_id=patient.id) }}" class="btn">
                            <i class="fas fa-plus"></i> Novo Plano
                        </a>
                    </div>
                    
                    <!-- Lista de Planos Alimentares -->
                    {% if patient.meal_plans %}
                    <div class="meal-plan-list">
                        {% for plan in patient.meal_plans|sort(attribute='start_date', reverse=True) %}
                        <div class="meal-plan-card 
                            {% if plan.start_date <= today and (not plan.end_date or plan.end_date >= today) %}active
                            {% elif plan.start_date > today %}future
                            {% else %}expired{% endif %}">
                            <div class="meal-plan-header">
                                <div class="meal-plan-title">{{ plan.title }}</div>
                                <div>{{ plan.total_calories }} kcal/dia</div>
                            </div>
                            <div class="meal-plan-dates">
                                <i class="far fa-calendar-alt"></i> 
                                {{ plan.start_date.strftime('%d/%m/%Y') }} 
                                {% if plan.end_date %}
                                    até {{ plan.end_date.strftime('%d/%m/%Y') }}
                                {% else %}
                                    (sem data final)
                                {% endif %}
                            </div>
                            <div class="meal-plan-actions">
                                <a href="{{ url_for('meal.meal_plan_detail', plan_id=plan.id) }}" class="btn btn-sm">
                                    <i class="fas fa-eye"></i> Ver Detalhes
                                </a>
                                <button class="btn btn-sm btn-danger" onclick="confirmMealPlanDelete({{ plan.id }}, '{{ plan.title }}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <!-- Formulário para exclusão de plano alimentar -->
                    <form id="deleteMealPlanForm" method="POST" style="display: none;">
                        <input type="hidden" name="meal_plan_id" id="mealPlanIdToDelete">
                    </form>
                    {% else %}
                    <div class="alert alert-info text-center">
                        Nenhum plano alimentar registrado para este paciente.
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Formulário para exclusão de paciente -->
            <form id="deletePatientForm" method="POST" action="{{ url_for('patient.delete_patient', patient_id=patient.id) }}" style="display: none;"></form>
            {% endif %}
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2023 NutriPlan - Sistema para Nutricionistas. Todos os direitos reservados.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/form-validation.js') }}"></script>
    <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
    
    <script>
        // Inicializar tabs
        document.addEventListener('DOMContentLoaded', function() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            if (tabBtns.length > 0) {
                tabBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        // Remover active de todos os botões e conteúdos
                        document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
                        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                        
                        // Adicionar active ao clicado
                        this.classList.add('active');
                        const tabId = this.getAttribute('data-tab');
                        document.getElementById(tabId).classList.add('active');
                        
                        // Salvar preferência no localStorage
                        localStorage.setItem('patientDetailActiveTab', tabId);
                    });
                });
                
                // Restaurar tab ativa do localStorage
                const activeTab = localStorage.getItem('patientDetailActiveTab');
                if (activeTab) {
                    const tabBtn = document.querySelector(`.tab-btn[data-tab="${activeTab}"]`);
                    if (tabBtn) tabBtn.click();
                }
            }
        });
        
        // Mostrar/esconder formulário de medição
        function showMeasurementForm() {
            document.getElementById('measurementForm').style.display = 'block';
            
            // Preencher altura da última medição, se existir
            {% if last_measurement %}
            document.getElementById('height').value = '{{ last_measurement.height }}';
            {% endif %}
            
            // Focar no campo de peso
            document.getElementById('weight').focus();
        }
        
        function hideMeasurementForm() {
            document.getElementById('measurementForm').style.display = 'none';
        }
        
        // Confirmar exclusões
        function confirmDelete(patientName) {
            if (confirm(`Tem certeza que deseja excluir o paciente "${patientName}"? Esta ação não pode ser desfeita e excluirá todas as medições e planos alimentares associados.`)) {
                document.getElementById('deletePatientForm').submit();
            }
        }
        
        function confirmMeasurementDelete(measurementId) {
            if (confirm('Tem certeza que deseja excluir esta medição? Esta ação não pode ser desfeita.')) {
                const form = document.getElementById('deleteMeasurementForm');
                form.action = `/patient/measurement/${measurementId}/delete`;
                form.submit();
            }
        }
        
        function confirmMealPlanDelete(planId, planTitle) {
            if (confirm(`Tem certeza que deseja excluir o plano "${planTitle}"? Esta ação não pode ser desfeita.`)) {
                const form = document.getElementById('deleteMealPlanForm');
                form.action = `/meal-plan/${planId}/delete`;
                form.submit();
            }
        }
        
        // Cálculo automático de IMC ao preencher peso e altura
        document.addEventListener('DOMContentLoaded', function() {
            const weightInput = document.getElementById('weight');
            const heightInput = document.getElementById('height');
            
            if (weightInput && heightInput) {
                const updateIMC = function() {
                    const weight = parseFloat(weightInput.value);
                    const height = parseFloat(heightInput.value);
                    
                    if (weight && height) {
                        const heightM = height / 100;
                        const imc = weight / (heightM * heightM);
                        
                        let classification = '';
                        if (imc < 18.5) classification = 'Abaixo do peso';
                        else if (imc < 25) classification = 'Peso normal';
                        else if (imc < 30) classification = 'Sobrepeso';
                        else if (imc < 35) classification = 'Obesidade Grau I';
                        else if (imc < 40) classification = 'Obesidade Grau II';
                        else classification = 'Obesidade Grau III';
                        
                        // Mostrar resultado
                        const result = document.getElementById('imcResult');
                        if (!result) {
                            const resultDiv = document.createElement('div');
                            resultDiv.id = 'imcResult';
                            resultDiv.className = 'alert alert-info mt-2';
                            resultDiv.innerHTML = `IMC calculado: <strong>${imc.toFixed(1)}</strong> - ${classification}`;
                            
                            // Inserir após o campo de altura
                            heightInput.parentNode.appendChild(resultDiv);
                        } else {
                            result.innerHTML = `IMC calculado: <strong>${imc.toFixed(1)}</strong> - ${classification}`;
                        }
                    }
                };
                
                weightInput.addEventListener('input', updateIMC);
                heightInput.addEventListener('input', updateIMC);
            }
        });
    </script>
</body>
</html>
